# æ‹¾å…‰å½±è§† APP - å¿«é€Ÿæ„å»ºæŒ‡å—

## ğŸš¨ ç½‘ç»œé—®é¢˜è§£å†³æ–¹æ¡ˆ

ç”±äºé¡¹ç›®ä½¿ç”¨äº† `media_kit` è§†é¢‘æ’­æ”¾å™¨ï¼Œæ„å»ºæ—¶éœ€è¦ä» GitHub ä¸‹è½½ä¾èµ–åº“ã€‚å¦‚æœé‡åˆ°ç½‘ç»œè¶…æ—¶ï¼Œè¯·æŒ‰ä»¥ä¸‹æ­¥éª¤æ“ä½œï¼š

### æ–¹æ³• 1ï¼šä½¿ç”¨ä¸‹è½½è„šæœ¬ï¼ˆæ¨èï¼‰

1. ä»¥ç®¡ç†å‘˜èº«ä»½è¿è¡Œ PowerShell
2. æ‰§è¡Œä¸‹è½½è„šæœ¬ï¼š
   ```powershell
   cd app
   .\download_libmpv.ps1
   ```
3. ç­‰å¾…ä¸‹è½½å®Œæˆåï¼Œé‡æ–°æ„å»º

### æ–¹æ³• 2ï¼šé…ç½®ä»£ç†

å¦‚æœä½ æœ‰ä»£ç†æœåŠ¡å™¨ï¼ˆå¦‚ Clashã€V2Ray ç­‰ï¼‰ï¼Œåœ¨ `android/gradle.properties` ä¸­æ·»åŠ ï¼š

```properties
systemProp.http.proxyHost=127.0.0.1
systemProp.http.proxyPort=7890
systemProp.https.proxyHost=127.0.0.1
systemProp.https.proxyPort=7890
```

**æ³¨æ„**ï¼šç«¯å£å·æ ¹æ®ä½ çš„ä»£ç†è½¯ä»¶è®¾ç½®è°ƒæ•´ï¼ˆå¸¸è§ç«¯å£ï¼š7890ã€10809ã€1080ï¼‰

### æ–¹æ³• 3ï¼šæ‰‹åŠ¨ä¸‹è½½

1. ä½¿ç”¨æµè§ˆå™¨æˆ–ä¸‹è½½å·¥å…·ä¸‹è½½ä»¥ä¸‹æ–‡ä»¶ï¼š
   - https://github.com/media-kit/libmpv-android-video-build/releases/download/v1.1.7/default-arm64-v8a.jar
   - https://github.com/media-kit/libmpv-android-video-build/releases/download/v1.1.7/default-armeabi-v7a.jar
   - https://github.com/media-kit/libmpv-android-video-build/releases/download/v1.1.7/default-x86_64.jar

2. å°†ä¸‹è½½çš„æ–‡ä»¶æ”¾åˆ°ä»¥ä¸‹ç›®å½•ï¼š
   ```
   %USERPROFILE%\.gradle\caches\modules-2\files-2.1\com.github.media-kit\libmpv-android-video-build\v1.1.7\
   ```

3. åˆ›å»ºç›®å½•ï¼ˆå¦‚æœä¸å­˜åœ¨ï¼‰ï¼š
   ```powershell
   mkdir "$env:USERPROFILE\.gradle\caches\modules-2\files-2.1\com.github.media-kit\libmpv-android-video-build\v1.1.7"
   ```

## ğŸ“¦ æ„å»ºæ­¥éª¤

### 1. å®‰è£…ä¾èµ–

```bash
cd app
flutter pub get
```

### 2. æ„å»º APK

#### é€‰é¡¹ Aï¼šæ„å»ºå•ä¸ªé€šç”¨ APKï¼ˆæ¨èæ–°æ‰‹ï¼‰

```bash
flutter build apk --release
```

è¾“å‡ºæ–‡ä»¶ï¼š`build/app/outputs/flutter-apk/app-release.apk`ï¼ˆçº¦ 50-60 MBï¼‰

#### é€‰é¡¹ Bï¼šæ„å»ºåˆ†æ¶æ„ APKï¼ˆæ¨èå‘å¸ƒï¼‰

```bash
flutter build apk --release --split-per-abi
```

è¾“å‡ºæ–‡ä»¶ï¼š
- `app-arm64-v8a-release.apk` - 64ä½ ARMï¼ˆçº¦ 25-30 MBï¼‰**â† æ¨è**
- `app-armeabi-v7a-release.apk` - 32ä½ ARMï¼ˆçº¦ 20-25 MBï¼‰
- `app-x86_64-release.apk` - 64ä½ x86ï¼ˆçº¦ 25-30 MBï¼‰

### 3. å®‰è£…åˆ°è®¾å¤‡

```bash
# é€šè¿‡ USB è¿æ¥è®¾å¤‡å
adb install build/app/outputs/flutter-apk/app-arm64-v8a-release.apk
```

æˆ–è€…ç›´æ¥å°† APK æ–‡ä»¶ä¼ è¾“åˆ°æ‰‹æœºå®‰è£…ã€‚

## ğŸ”§ ä½¿ç”¨ Android Studio æ„å»º

å¦‚æœå‘½ä»¤è¡Œæ„å»ºå¤±è´¥ï¼Œå¯ä»¥ä½¿ç”¨ Android Studioï¼š

1. æ‰“å¼€ Android Studio
2. é€‰æ‹© `File` â†’ `Open`
3. æ‰“å¼€é¡¹ç›®çš„ `android` ç›®å½•
4. ç­‰å¾… Gradle åŒæ­¥å®Œæˆ
5. é€‰æ‹© `Build` â†’ `Build Bundle(s) / APK(s)` â†’ `Build APK(s)`
6. ç­‰å¾…æ„å»ºå®Œæˆ

## âš¡ å¿«é€Ÿæµ‹è¯•ï¼ˆDebug æ¨¡å¼ï¼‰

å¦‚æœåªæ˜¯æƒ³å¿«é€Ÿæµ‹è¯•ï¼Œå¯ä»¥æ„å»º Debug ç‰ˆæœ¬ï¼ˆä¸éœ€è¦ä¸‹è½½ libmpvï¼‰ï¼š

```bash
flutter run
```

æˆ–ï¼š

```bash
flutter build apk --debug
```

## ğŸ› å¸¸è§é—®é¢˜

### é—®é¢˜ 1ï¼šConnection timed out

**åŸå› **ï¼šæ— æ³•è¿æ¥åˆ° GitHub ä¸‹è½½ä¾èµ–

**è§£å†³**ï¼šä½¿ç”¨ä¸Šé¢çš„æ–¹æ³• 1ã€2 æˆ– 3

### é—®é¢˜ 2ï¼šGradle åŒæ­¥å¤±è´¥

**åŸå› **ï¼šGradle ä¾èµ–ä¸‹è½½å¤±è´¥

**è§£å†³**ï¼š
- å·²é…ç½®é˜¿é‡Œäº‘é•œåƒï¼Œåº”è¯¥å¯ä»¥æ­£å¸¸ä¸‹è½½
- å¦‚æœä»ç„¶å¤±è´¥ï¼Œæ£€æŸ¥ç½‘ç»œè¿æ¥
- å°è¯•ä½¿ç”¨ Android Studio åŒæ­¥

### é—®é¢˜ 3ï¼šå†…å­˜ä¸è¶³

**åŸå› **ï¼šGradle æ„å»ºéœ€è¦å¤§é‡å†…å­˜

**è§£å†³**ï¼šå·²åœ¨ `gradle.properties` ä¸­é…ç½® 8GB å†…å­˜ï¼Œåº”è¯¥è¶³å¤Ÿ

### é—®é¢˜ 4ï¼šæ‰¾ä¸åˆ° Flutter SDK

**åŸå› **ï¼šFlutter ç¯å¢ƒå˜é‡æœªé…ç½®

**è§£å†³**ï¼š
```bash
flutter doctor
```
æ£€æŸ¥ Flutter å®‰è£…æ˜¯å¦æ­£ç¡®

## ğŸ“± æµ‹è¯• APK

### åŠŸèƒ½æµ‹è¯•æ¸…å•

å®‰è£… APK åï¼Œè¯·æµ‹è¯•ä»¥ä¸‹åŠŸèƒ½ï¼š

- [ ] å¯åŠ¨é¡µå’Œå¼€å±å¹¿å‘Š
- [ ] é¦–é¡µåŠ¨æ€å¸ƒå±€åŠ è½½
- [ ] è§†é¢‘æ’­æ”¾
- [ ] çŸ­å‰§æ’­æ”¾
- [ ] æœç´¢åŠŸèƒ½
- [ ] ç”¨æˆ·ç™»å½•/æ³¨å†Œ
- [ ] ä¸ªäººä¸­å¿ƒ
- [ ] è§‚çœ‹å†å²
- [ ] æ”¶è—åŠŸèƒ½
- [ ] åˆ†äº«åŠŸèƒ½
- [ ] åº”ç”¨æ›´æ–°

### æŸ¥çœ‹æ—¥å¿—

```bash
# è¿æ¥è®¾å¤‡å
adb logcat | findstr flutter
```

æˆ–ä½¿ç”¨ Android Studio çš„ Logcat å·¥å…·ã€‚

## ğŸ“Š æ„å»ºè¾“å‡ºè¯´æ˜

### APK æ–‡ä»¶å¤§å°

- **é€šç”¨ç‰ˆæœ¬**ï¼š50-60 MBï¼ˆåŒ…å«æ‰€æœ‰æ¶æ„ï¼‰
- **arm64-v8a**ï¼š25-30 MBï¼ˆæ¨èï¼Œè¦†ç›– 95% ç°ä»£è®¾å¤‡ï¼‰
- **armeabi-v7a**ï¼š20-25 MBï¼ˆå…¼å®¹è€è®¾å¤‡ï¼‰
- **x86_64**ï¼š25-30 MBï¼ˆæ¨¡æ‹Ÿå™¨å’Œå°‘æ•°è®¾å¤‡ï¼‰

### æ¨èå‘å¸ƒç­–ç•¥

1. **ä¸»è¦ç‰ˆæœ¬**ï¼šå‘å¸ƒ `app-arm64-v8a-release.apk`
2. **å…¼å®¹ç‰ˆæœ¬**ï¼šåŒæ—¶æä¾› `app-armeabi-v7a-release.apk`
3. **é€šç”¨ç‰ˆæœ¬**ï¼šæä¾› `app-release.apk` ä½œä¸ºå¤‡é€‰

## ğŸ¯ ä¸‹ä¸€æ­¥

æ„å»ºæˆåŠŸåï¼š

1. å®‰è£…åˆ°çœŸæœºæµ‹è¯•æ‰€æœ‰åŠŸèƒ½
2. æ£€æŸ¥æ€§èƒ½å’Œç¨³å®šæ€§
3. ä¿®å¤å‘ç°çš„é—®é¢˜
4. å‡†å¤‡å‘å¸ƒ

## ğŸ“š ç›¸å…³æ–‡æ¡£

- `BUILD_GUIDE.md` - è¯¦ç»†æ„å»ºæŒ‡å—
- `BUILD_CONFIG.md` - Android æ„å»ºé…ç½®è¯´æ˜
- `TESTING_GUIDE.md` - æµ‹è¯•æŒ‡å—
- `PROJECT_STATUS.md` - é¡¹ç›®çŠ¶æ€

---

**æç¤º**ï¼šå¦‚æœé‡åˆ°å…¶ä»–é—®é¢˜ï¼Œè¯·æŸ¥çœ‹ `BUILD_GUIDE.md` è·å–æ›´è¯¦ç»†çš„è¯´æ˜ã€‚

**æœ€åæ›´æ–°**ï¼š2024-12-06
