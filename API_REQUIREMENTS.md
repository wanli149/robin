# å…¨å±€æ’­æ”¾å™¨ç³»ç»Ÿ API æ¥å£éœ€æ±‚

## æ¦‚è¿°

å…¨å±€æ’­æ”¾å™¨ç³»ç»Ÿéœ€è¦ä»¥ä¸‹ API æ¥å£æ¥æ”¯æŒå„ç§æ’­æ”¾åœºæ™¯ã€‚æ‰€æœ‰æ¥å£éƒ½åº”è¯¥è¿”å›ç»Ÿä¸€çš„å“åº”æ ¼å¼ã€‚

## ç»Ÿä¸€å“åº”æ ¼å¼

```json
{
  "code": 1,           // 1: æˆåŠŸ, 0: å¤±è´¥
  "msg": "success",    // å“åº”æ¶ˆæ¯
  "data": {...}        // å“åº”æ•°æ®
}
```

---

## 1. çŸ­å‰§ç›¸å…³æ¥å£

### 1.1 è·å–çŸ­å‰§è¯¦æƒ…å’Œé€‰é›†åˆ—è¡¨

**æ¥å£**: `GET /api/shorts/series/{seriesId}`

**ç”¨é€”**: çŸ­å‰§è¯¦æƒ…é¡µè·å–åŸºæœ¬ä¿¡æ¯å’Œé€‰é›†åˆ—è¡¨

**å“åº”ç¤ºä¾‹**:
```json
{
  "code": 1,
  "msg": "success",
  "data": {
    "series_id": "12345",
    "vod_name": "éœ¸é“æ€»è£çˆ±ä¸Šæˆ‘",
    "vod_pic_vertical": "https://example.com/cover.jpg",
    "vod_content": "å‰§æƒ…ç®€ä»‹...",
    "category": "éƒ½å¸‚è¨€æƒ…",
    "total_episodes": 100,
    "episodes": [
      {
        "vod_id": "ep001",
        "episode_index": 1,
        "episode_name": "ç¬¬1é›†",
        "play_url": "https://example.com/video1.m3u8"
      },
      {
        "vod_id": "ep002", 
        "episode_index": 2,
        "episode_name": "ç¬¬2é›†",
        "play_url": "https://example.com/video2.m3u8"
      }
    ]
  }
}
```

### 1.2 è·å–éšæœºçŸ­å‰§æµ

**æ¥å£**: `GET /api/shorts/random`

**ç”¨é€”**: çŸ­å‰§æµé¡µé¢è·å–éšæœºçŸ­å‰§åˆ—è¡¨

**å“åº”ç¤ºä¾‹**:
```json
{
  "code": 1,
  "msg": "success",
  "list": [
    {
      "vod_id": "12345",
      "series_id": "series001",
      "vod_name": "éœ¸é“æ€»è£çˆ±ä¸Šæˆ‘",
      "vod_pic_vertical": "https://example.com/cover1.jpg",
      "category": "éƒ½å¸‚è¨€æƒ…",
      "play_url": "https://example.com/video1.m3u8"
    },
    {
      "vod_id": "12346",
      "series_id": "series002", 
      "vod_name": "ç©¿è¶Šä¹‹ç‹å¦ƒè¦é€†å¤©",
      "vod_pic_vertical": "https://example.com/cover2.jpg",
      "category": "å¤è£…ç©¿è¶Š",
      "play_url": "https://example.com/video2.m3u8"
    }
  ]
}
```

---

## 2. ç”µè§†å‰§/ç”µå½±ç›¸å…³æ¥å£

### 2.1 è·å–è§†é¢‘è¯¦æƒ…

**æ¥å£**: `GET /api/vod/detail?ids={vodId}`

**ç”¨é€”**: ç”µè§†å‰§/ç”µå½±è¯¦æƒ…é¡µè·å–åŸºæœ¬ä¿¡æ¯å’Œæ’­æ”¾åœ°å€

**å“åº”ç¤ºä¾‹**:
```json
{
  "code": 1,
  "msg": "success", 
  "data": {
    "vod_id": "12345",
    "vod_name": "åº†ä½™å¹´",
    "vod_pic": "https://example.com/poster.jpg",
    "vod_content": "å‰§æƒ…ç®€ä»‹...",
    "vod_year": "2019",
    "vod_area": "ä¸­å›½å¤§é™†",
    "vod_director": "å­™çš“",
    "vod_actor": "å¼ è‹¥æ˜€,ææ²,é™ˆé“æ˜",
    "vod_play_from": "m3u8$$mp4",
    "vod_play_url": "ç¬¬01é›†$https://example.com/ep1.m3u8#ç¬¬02é›†$https://example.com/ep2.m3u8$$ç¬¬01é›†$https://example.com/ep1.mp4#ç¬¬02é›†$https://example.com/ep2.mp4"
  },
  "recommendations": [
    {
      "vod_id": "12346",
      "vod_name": "ç…çŠæ¦œ",
      "vod_pic": "https://example.com/poster2.jpg",
      "vod_remarks": "å…¨46é›†"
    }
  ]
}
```

---

## 3. å¹¿å‘Šç›¸å…³æ¥å£

### 3.1 è·å–æš‚åœå¹¿å‘Šé…ç½®

**æ¥å£**: `GET /api/ad/pause`

**ç”¨é€”**: è·å–æš‚åœå¹¿å‘Šçš„é…ç½®ä¿¡æ¯

**å“åº”ç¤ºä¾‹**:
```json
{
  "code": 1,
  "msg": "success",
  "data": {
    "content_type": "image",
    "media_url": "https://example.com/ad_image.jpg",
    "title": "é™æ—¶ä¼˜æƒ ",
    "description": "æ–°ç”¨æˆ·ä¸“äº«ï¼Œç«‹å³é¢†å–ä¼˜æƒ åˆ¸",
    "action_type": "webview",
    "action_url": "webview://https://example.com/promotion"
  }
}
```

**å­—æ®µè¯´æ˜**:
- `content_type`: å¹¿å‘Šå†…å®¹ç±»å‹ (`image` | `video`)
- `media_url`: å¹¿å‘Šåª’ä½“æ–‡ä»¶åœ°å€
- `title`: å¹¿å‘Šæ ‡é¢˜
- `description`: å¹¿å‘Šæè¿°
- `action_type`: ç‚¹å‡»è¡Œä¸ºç±»å‹ (`webview` | `external` | `app`)
- `action_url`: ç‚¹å‡»è·³è½¬åœ°å€

---

## 4. é€šç”¨æ¥å£

### 4.1 è§£æåˆ†äº«é“¾æ¥

**æ¥å£**: `GET /api/vod/parse_share?url={shareUrl}`

**ç”¨é€”**: è§£æåˆ†äº«é“¾æ¥è·å–çœŸå®æ’­æ”¾åœ°å€

**å“åº”ç¤ºä¾‹**:
```json
{
  "code": 1,
  "msg": "success",
  "data": {
    "video_url": "https://example.com/real_video.m3u8"
  }
}
```

### 4.2 è§£ææ’­æ”¾åœ°å€

**æ¥å£**: `GET /api/vod/resolve_url?url={playUrl}`

**ç”¨é€”**: è§£ææ’­æ”¾åœ°å€ï¼ˆå¦‚æœéœ€è¦äºŒæ¬¡è§£æï¼‰

**å“åº”ç¤ºä¾‹**:
```json
{
  "code": 1,
  "msg": "success", 
  "data": {
    "resolved_url": "https://example.com/resolved_video.m3u8"
  }
}
```

---

## 5. æ’­æ”¾å™¨é…ç½®åœºæ™¯

### 4.1 çŸ­å‰§è¯¦æƒ…é¡µ
- **å†…å®¹ç±»å‹**: `ContentType.shorts`
- **æ’­æ”¾å™¨é…ç½®**: `PlayerConfig.shortsWindow()` (æ¨ªå± 16:9)
- **API**: `/api/shorts/series/{seriesId}`
- **ç‰¹æ€§**: é€‰é›†åˆ‡æ¢ã€å…¨å±æ”¯æŒ

### 4.2 çŸ­å‰§æµé¡µé¢
- **å†…å®¹ç±»å‹**: `ContentType.shortsFlow`
- **æ’­æ”¾å™¨é…ç½®**: `PlayerConfig.shortsFlow()` (ç«–å± 9:16)
- **API**: `/api/shorts/random`
- **ç‰¹æ€§**: æ»‘åŠ¨åˆ‡æ¢ã€30%å¼•å¯¼æç¤º

### 4.3 ç”µè§†å‰§è¯¦æƒ…é¡µ
- **å†…å®¹ç±»å‹**: `ContentType.tv`
- **æ’­æ”¾å™¨é…ç½®**: `PlayerConfig.tvWindow()` (æ¨ªå± 16:9)
- **API**: `/api/vod/detail`
- **ç‰¹æ€§**: é€‰é›†åˆ‡æ¢ã€æ”¶è—é¢„çº¦

### 4.4 ç”µå½±è¯¦æƒ…é¡µ
- **å†…å®¹ç±»å‹**: `ContentType.movie`
- **æ’­æ”¾å™¨é…ç½®**: `PlayerConfig.tvWindow()` (æ¨ªå± 16:9)
- **API**: `/api/vod/detail`
- **ç‰¹æ€§**: å•é›†æ’­æ”¾ã€æ”¶è—é¢„çº¦

---

## 6. é”™è¯¯å¤„ç†

æ‰€æœ‰æ¥å£åœ¨å‡ºé”™æ—¶åº”è¿”å›ï¼š
```json
{
  "code": 0,
  "msg": "é”™è¯¯æè¿°",
  "data": null
}
```

å¸¸è§é”™è¯¯ç ï¼š
- `code: 0` - è¯·æ±‚å¤±è´¥
- `code: 1` - è¯·æ±‚æˆåŠŸ

---

## 7. æ€§èƒ½ä¼˜åŒ–å»ºè®®

1. **ç¼“å­˜ç­–ç•¥**: çŸ­å‰§è¯¦æƒ…å’Œé€‰é›†åˆ—è¡¨å»ºè®®ç¼“å­˜ 5-10 åˆ†é’Ÿ
2. **é¢„åŠ è½½**: æ”¯æŒæ‰¹é‡è·å–å¤šé›†æ’­æ”¾åœ°å€
3. **CDN**: æ’­æ”¾åœ°å€åº”ä½¿ç”¨ CDN åŠ é€Ÿ
4. **å‹ç¼©**: å“åº”æ•°æ®å»ºè®®å¯ç”¨ gzip å‹ç¼©

---

## 8. å®‰å…¨è€ƒè™‘

1. **é˜²ç›—é“¾**: æ’­æ”¾åœ°å€åº”åŒ…å«æ—¶æ•ˆæ€§ token
2. **é™æµ**: å¯¹éšæœºçŸ­å‰§æ¥å£è¿›è¡Œé€‚å½“é™æµ
3. **éªŒè¯**: å¯¹åˆ†äº«é“¾æ¥è¿›è¡Œå®‰å…¨éªŒè¯

---

## 9. ç›‘æ§æŒ‡æ ‡

å»ºè®®ç›‘æ§ä»¥ä¸‹æŒ‡æ ‡ï¼š
- API å“åº”æ—¶é—´
- æ’­æ”¾åœ°å€æœ‰æ•ˆæ€§
- ç”¨æˆ·æ’­æ”¾è¡Œä¸º
- é”™è¯¯ç‡ç»Ÿè®¡

---

## 10. ç”¨æˆ·è®¤è¯æ¥å£

### 10.1 ç”¨æˆ·ç™»å½•

**æ¥å£**: `POST /api/auth/login`

**ç”¨é€”**: ç”¨æˆ·ç™»å½•ï¼Œè·å–æ°¸ä¹…tokenï¼Œå¯ç”¨å†å²è®°å½•å’Œæ”¶è—åŠŸèƒ½

**è¯·æ±‚å‚æ•°**:
```json
{
  "username": "ç”¨æˆ·å",
  "password": "å¯†ç "
}
```

**å“åº”ç¤ºä¾‹**:
```json
{
  "code": 1,
  "msg": "ç™»å½•æˆåŠŸ",
  "data": {
    "token": "æ°¸ä¹…æœ‰æ•ˆçš„JWT token",
    "user": {
      "user_id": "12345",
      "username": "å¼ ä¸‰",
      "avatar": "https://example.com/avatar.jpg",
      "is_vip": false,
      "vip_expire_date": null
    }
  }
}
```

### 10.2 ç”¨æˆ·æ³¨å†Œ

**æ¥å£**: `POST /api/auth/register`

**ç”¨é€”**: ç”¨æˆ·æ³¨å†Œï¼Œç®€åŒ–æµç¨‹ï¼Œæ— éœ€éªŒè¯

**è¯·æ±‚å‚æ•°**:
```json
{
  "username": "ç”¨æˆ·åï¼ˆâ‰¥3ä½ï¼Œå¯ä»¥æ˜¯æ™®é€šç”¨æˆ·åæˆ–é‚®ç®±æ ¼å¼ï¼‰",
  "password": "å¯†ç ï¼ˆâ‰¥6ä½ï¼‰"
}
```

**å“åº”ç¤ºä¾‹**:
```json
{
  "code": 1,
  "msg": "æ³¨å†ŒæˆåŠŸ",
  "data": {
    "user_id": "12345"
  }
}
```

### 10.3 è®¾è®¡ç†å¿µ

**ç®€åŒ–ç”¨æˆ·ä½“éªŒ**:
- ğŸš€ **æç®€æ³¨å†Œ**: åªéœ€ç”¨æˆ·å+å¯†ç ï¼Œç”¨æˆ·åå¯ä»¥æ˜¯ä»»æ„æ ¼å¼ï¼ˆæ™®é€šç”¨æˆ·åæˆ–é‚®ç®±ï¼‰
- ğŸ”’ **æ°¸ä¹…ç™»å½•**: ç™»å½•åæ°¸ä¹…ä¿æŒï¼Œé™¤éç”¨æˆ·ä¸»åŠ¨é€€å‡ºæˆ–æ¢è®¾å¤‡
- ğŸ“± **æ ¸å¿ƒåŠŸèƒ½**: ç™»å½•ä¸»è¦ç”¨äºè§‚çœ‹å†å²å’Œæ”¶è—åŠŸèƒ½
- ğŸ¯ **ä½é—¨æ§›**: åŒ¿åç”¨æˆ·å¯ç›´æ¥è§‚çœ‹ï¼Œéœ€è¦æ—¶å†æ³¨å†Œ
- âŒ **æ— æ‰¾å›å¯†ç **: ç”¨æˆ·è‡ªå·±è®°ä½è´¦å·å¯†ç å³å¯
- ğŸ“ **çµæ´»ç”¨æˆ·å**: æ”¯æŒ `dfdffege` æˆ– `dfdffeef@163.com` ç­‰ä»»æ„æ ¼å¼

**é€‚ç”¨åœºæ™¯**:
- CFè¾¹ç¼˜éƒ¨ç½²ç¯å¢ƒ
- å½±è§†APPå¿«é€Ÿä½“éªŒ
- é™ä½ç”¨æˆ·ä½¿ç”¨é—¨æ§›